{"version":3,"sources":["view/Login.js","view/Page.js","router/AppRoute.js","App.js","reportWebVitals.js","index.js"],"names":["Login","state","randomBytes","toString","nonce","useEffect","query","url","parse","window","location","href","Object","keys","length","link","process","lineLogin","callbackURL","prototype","hasOwnProperty","call","reqBody","grant_type","code","redirect_uri","client_id","client_secret","axios","post","qs","stringify","headers","then","res","decodedIdToken","jwt","verify","data","id_token","algorithms","audience","issuer","document","cookie","sub","cookieId","replace","setTimeout","err","console","log","catch","error","alert","getAccessToken","ConferenceRegistration","lineId","useState","name","id","caseData","setCaseData","setState","caseList","getUrlString","caseId","URL","hash","split","sessionStorage","setItem","localStorage","undefined","map","item","index","style","position","top","left","transform","width","fontSize","getItem","textAlign","AppRoute","props","exact","path","Page","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.8f015b4d.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport randomBytes from \"randombytes\"\r\n\r\nimport axios from 'axios';\r\nimport url from 'url';\r\nimport qs from 'qs';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst Login = () => {\r\n    const state = randomBytes(32).toString('hex');\r\n    const nonce = randomBytes(32).toString('hex');\r\n\r\n    const lineLogin = () => {\r\n        let link = 'https://access.line.me/oauth2/v2.1/authorize?';\r\n        link += 'response_type=code';\r\n        link += `&client_id=${process.env.REACT_APP_LINE_LOGIN_CHANNEL_ID_TEST}`;\r\n        link += `&redirect_uri=${process.env.REACT_APP_LINE_LOGIN_CALLBACK_URL_TEST}`;\r\n        link += `&state=${state}`;\r\n        link += `&nonce=${nonce}`;\r\n        link += '&scope=openid%20profile';\r\n        link += '&bot_prompt=normal';\r\n        window.location.href = link;\r\n    };\r\n    useEffect(() => {\r\n        var urlParts = url.parse(window.location.href, true);\r\n        var query = urlParts.query;\r\n        const isLogin = () => {\r\n            if (Object.keys(query).length === 0) {\r\n                lineLogin();\r\n            }\r\n        }\r\n        isLogin()\r\n    });\r\n\r\n    const getAccessToken = (callbackURL) => {\r\n        var urlParts = url.parse(callbackURL, true);\r\n        var query = urlParts.query;\r\n        var hasCodeProperty = Object.prototype.hasOwnProperty.call(query, 'code');\r\n        if (hasCodeProperty) {\r\n            const reqBody = {\r\n                grant_type: 'authorization_code',\r\n                code: query.code,\r\n                redirect_uri: `${process.env.REACT_APP_LINE_LOGIN_CALLBACK_URL_TEST}`,\r\n                client_id: `${process.env.REACT_APP_LINE_LOGIN_CHANNEL_ID_TEST}`,\r\n                client_secret: `${process.env.REACT_APP_LINE_LOGIN_CHANNEL_SECRET_TEST}`\r\n            };\r\n            const reqConfig = {\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded'\r\n                }\r\n            };\r\n            axios\r\n                .post(\r\n                    'https://api.line.me/oauth2/v2.1/token',\r\n                    qs.stringify(reqBody),\r\n                    reqConfig\r\n                )\r\n                .then((res) => {\r\n                    try {\r\n                        const decodedIdToken = jwt.verify(res.data.id_token, `${process.env.REACT_APP_LINE_LOGIN_CHANNEL_SECRET_TEST}`, {\r\n                            algorithms: ['HS256'],\r\n                            audience: `${process.env.REACT_APP_LINE_LOGIN_CHANNEL_ID_TEST}`.toString(),\r\n                            issuer: 'https://access.line.me',\r\n                            // nonce: `${newId}`\r\n                        });\r\n                        document.cookie = `lineIdToken=${decodedIdToken.sub};`;\r\n                        const cookieId = document.cookie.replace(/(?:(?:^|.*;\\s*)cookieId\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\r\n                        setTimeout(() => { window.location.href = `https://chennalhua.github.io/lineLogin/#/page?id=${cookieId}` }, 1000);\r\n                    } catch (err) {\r\n                        // If token is invalid.\r\n                        console.log(err);\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n        } else if (query.error) {\r\n            alert('需「許可」授權，才能驗證登入')\r\n        }\r\n    };\r\n    useEffect(() => {\r\n        getAccessToken(window.location.href)\r\n    }, []);\r\n    return (\r\n        <div>\r\n            頁面導回中...\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login","import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport Loading from './Loading';\r\n\r\nconst ConferenceRegistration = () => {\r\n    const lineId = document.cookie.replace(/(?:(?:^|.*;\\s*)lineIdToken\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\r\n    const cookieId = document.cookie.replace(/(?:(?:^|.*;\\s*)cookieId\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\r\n    let [caseData, setCaseData] = useState({ name: null, id: null }),\r\n        [state, setState] = useState(null) //狀態(接 API Response data)\r\n\r\n    let caseList = [\r\n        { id: '001', name: '新年快樂' }\r\n    ]\r\n    useEffect(() => {\r\n        //抓課程 id\r\n        var getUrlString = window.location.href;\r\n        var url = new URL(getUrlString);\r\n        let caseId = url.hash.split('#')[1].split('?')[1].split('=')[1]\r\n\r\n        sessionStorage.setItem('sessionCaseId', caseId)\r\n        localStorage.setItem('localCaseId', caseId)\r\n        document.cookie = `cookieId=${caseId};`;\r\n        //抓 line id\r\n        if (lineId === '' || lineId === null || lineId === undefined) {\r\n            setTimeout(() => {\r\n                window.location.href = '/'\r\n            }, 3000)\r\n            return\r\n        } else if (caseId == null || caseId == 'null' || caseId == '' || caseId == undefined) {\r\n            setState('抓 ID 錯誤 !!')\r\n            return\r\n        } else {\r\n            caseList.map((item, index) => {\r\n                if (cookieId == item.id) {\r\n                    setCaseData({ name: item.name, id: item.id })\r\n                }\r\n            })\r\n        }\r\n    }, [])\r\n    useEffect(() => { }, [state])\r\n    useEffect(() => { }, [])\r\n\r\n    let style = {\r\n        position: 'absolute',\r\n        top: '35%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n        width: '100%'\r\n    }\r\n    return (\r\n        <>\r\n            <div style={{ style }}>\r\n                <p>{window.location.href}</p>\r\n                <ul style={{ fontSize: '18px' }}>\r\n                    <li>cookies：{cookieId}</li>\r\n                    <li>localStorage：{localStorage.getItem('localCaseId')}</li>\r\n                    <li>sessionStorage：{sessionStorage.getItem('sessionCaseId')}</li>\r\n                </ul>\r\n                <div style={{ textAlign: 'center', fontSize: '20px' }}>{state}</div>\r\n                <div style={{ textAlign: 'center', fontSize: '20px' }}>{caseData.name}</div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ConferenceRegistration","import React from 'react';\r\nimport { HashRouter  as Router, Route, Redirect, NotFoundRoute } from \"react-router-dom\";\r\n// import { BrowserRouter  as Router, Route, Redirect, NotFoundRoute } from \"react-router-dom\";\r\n\r\nimport Login from \"../view/Login\"; //登入\r\nimport Test from \"../view/Test\"; //登入\r\nimport Page from \"../view/Page\"\r\n\r\nconst AppRoute = (props) => {\r\n    return (\r\n        <Router>\r\n            <Route exact path=\"/\"><Login /></Route> {/* 登入 */}\r\n            <Route exact path=\"/page\"><Page /></Route> {/* 登入 */}\r\n        </Router>\r\n    )\r\n}\r\n\r\nexport default AppRoute","import React, { useState, useEffect } from 'react';\r\nimport AppRoute from './router/AppRoute';\r\n\r\nconst App = () => {\r\n  return (\r\n    <>\r\n      <AppRoute />\r\n    </>\r\n  );\r\n}\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}